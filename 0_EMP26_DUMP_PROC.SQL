CREATE OR REPLACE PROCEDURE EMP26_DUMP
IS
    HANDLES UTL_FILE.FILE_TYPE;
    BUFFERS VARCHAR2(100);
    COUNTS NUMBER := 0;
    DIRS VARCHAR2(40):='/ARCH/BDEEXTRACT';
BEGIN
    HANDLES := UTL_FILE.FOPEN('NL_ASSIGNMENTS','EMP_DUMP.CSV', 'W');
    UTL_FILE.PUT_LINE(HANDLES, 'FIRST NAME'||','||'LAST NAME'||','||'EMAIL');
    
    FOR EMPS IN ( SELECT ID, NAME, SALARY FROM EMP26) LOOP
        BUFFERS := EMPS.ID||','||EMPS.NAME||','||EMPS.SALARY;
        UTL_FILE.PUT_LINE(HANDLES, BUFFERS);
        COUNTS := COUNTS + 1;
    END LOOP;    
    UTL_FILE.FCLOSE(HANDLES);
    DBMS_OUTPUT.PUT_LINE( COUNTS||' RECORDS WRITTEN TO EMP_DUMP.CSV.');
END;
