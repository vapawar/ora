CREATE OR REPLACE PROCEDURE PROC_TAB_CHECK(TB_NAME VARCHAR2, PROC_NAME VARCHAR2)
AS

STR VARCHAR2(90);
TNAME VARCHAR2(20);
PNAME VARCHAR2(20);
TB_EXCEPT EXCEPTION;
PROC_EXCEPT EXCEPTION;
CURSOR TCURSOR IS SELECT OBJECT_NAME FROM  USER_OBJECTS WHERE OBJECT_NAME=TB_NAME;
CURSOR PCURSOR IS SELECT OBJECT_NAME FROM  USER_OBJECTS WHERE OBJECT_NAME=PROC_NAME;
BEGIN
OPEN TCURSOR;
OPEN PCURSOR;
FETCH TCURSOR INTO TNAME;
FETCH PCURSOR INTO PNAME;

IF TNAME IS NULL THEN
RAISE TB_EXCEPT;
END IF;
IF PNAME IS NULL THEN
RAISE PROC_EXCEPT;
END IF;

STR:='BEGIN '||PROC_NAME||'('''||TB_NAME||''')'||'; END;';
DBMS_OUTPUT.PUT_LINE(STR);
EXECUTE IMMEDIATE STR;
EXCEPTION
WHEN TB_EXCEPT THEN
DBMS_OUTPUT.PUT_LINE('TABLE NOT EXISTS.');
WHEN PROC_EXCEPT THEN
DBMS_OUTPUT.PUT_LINE('PROCEDURE NOT EXISTS.');
WHEN OTHERS THEN
DBMS_OUTPUT.PUT_LINE('ERROR: '||SQLERRM);
END;






CREATE OR REPLACE PROCEDURE PROC_GET_CONSTRAINTS(TB_NAME VARCHAR2)
AS
RCOUNT NUMBER;
STR VARCHAR2(90);
CURSOR INDEX_CURSOR IS SELECT INDEX_NAME FROM USER_INDEXES WHERE TABLE_NAME=TB_NAME;
CURSOR TRIGGER_CURSOR IS SELECT TRIGGER_NAME FROM USER_TRIGGERS WHERE TABLE_NAME=TB_NAME;
CURSOR CONSTRAINT_CURSOR IS SELECT CONSTRAINT_NAME FROM USER_CONSTRAINTS WHERE TABLE_NAME=TB_NAME;
CURSOR TAB_COLS_CURSOR IS SELECT COLUMN_NAME , DATA_TYPE FROM USER_TAB_COLS WHERE TABLE_NAME=TB_NAME;

BEGIN
STR:= 'SELECT COUNT(*) FROM '||TB_NAME;
EXECUTE IMMEDIATE STR INTO RCOUNT;
DBMS_OUTPUT.PUT_LINE('TABLE HAS '||RCOUNT||' ROWS.');

FOR DT IN INDEX_CURSOR LOOP
DBMS_OUTPUT.PUT_LINE('INDEX: '||DT.INDEX_NAME);
END LOOP;
FOR DT IN TRIGGER_CURSOR LOOP
DBMS_OUTPUT.PUT_LINE('TRIGGER: '||DT.TRIGGER_NAME);
END LOOP;
FOR DT IN CONSTRAINT_CURSOR LOOP
DBMS_OUTPUT.PUT_LINE('CONSTRAINTS: '||DT.CONSTRAINT_NAME);
END LOOP;
FOR DT IN TAB_COLS_CURSOR LOOP
DBMS_OUTPUT.PUT_LINE('COLUMN NAME: '||RPAD(DT.COLUMN_NAME,20)||' DATA TYPE: '||DT.DATA_TYPE);
END LOOP;

EXCEPTION
WHEN OTHERS THEN
DBMS_OUTPUT.PUT_LINE(SQLERRM);
END;




BEGIN
PROC_TAB_CHECK('CUSTOMERS_ASGN','PROC_GET_CONSTRAINTS');
END;

BEGIN
PROC_GET_CONSTRAINTS('CUSTOMERS_ASG');
END;
